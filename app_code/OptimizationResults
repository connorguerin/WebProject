Imports Microsoft.VisualBasic
Imports Microsoft.SolverFoundation.Services
Imports System.Data

'the purpose of this class is to convert the output of the scheduling models into datatables to be used in the gridviews
Public Class OptimizationResults
    Private myCustomerList As List(Of Customer)
    Private myRoomList As List(Of Room)
    Private myRoomAssignments(,) As Decision
    Private myEmployeeAssignments(,,) As Decision
    Private myEmployeeList As List(Of Employee)

    'constructor for room assignments instance
    Public Sub New(ByVal aDecisionMatrix(,) As Decision, ByVal aCustomerList As List(Of Customer), ByVal aRoomList As List(Of Room))
        myRoomAssignments = aDecisionMatrix
        myCustomerList = aCustomerList
        myRoomList = aRoomList
    End Sub

    'constructor for scheduling assignments instance
    Public Sub New(ByVal aDecisionMatrix(,,) As Decision, ByVal anEmployeeList As List(Of Employee))
        myEmployeeAssignments = aDecisionMatrix
        myEmployeeList = anEmployeeList
    End Sub

    'function for formatting room results
    Public Function RoomResultsToDataTable() As DataTable
        Dim returnTable As New DataTable
        returnTable.Columns.Add("Room")
        returnTable.Columns.Add("Customer")
        returnTable.Columns.Add("Visit ID")
        Dim occupied As Boolean
        Dim currentCustomer As Integer
        Dim foo As String = ""
        'iterate through rooms
        For i = 0 To myRoomList.Count - 1
            currentCustomer = 0
            'check to see if any customer has been assigned to the room
            For j = 0 To myCustomerList.Count - 1
                occupied = False
                If myRoomAssignments(i, j).ToDouble = 1 Then
                    'foo is just a dummy variable used for debugging purposes
                    foo &= ("Room " & i & " occupied by customer " & j & vbCrLf)
                    occupied = True
                    currentCustomer = j
                End If
                'if the room is occupied, add a formatted row to the datatable
                If occupied Then
                    Dim newrow As DataRow = returnTable.NewRow
                    newrow("Room") = CStr(myRoomList.Item(i).RoomNum) & " Reserved By:"
                    newrow("Customer") = CStr(myCustomerList.Item(currentCustomer).getName)
                    newrow("Visit ID") = CStr(myCustomerList.Item(currentCustomer).getID)

                    returnTable.Rows.Add(newrow)
                End If
            Next

        Next
        Return returnTable
    End Function

    Public Function EmployeeResultsToDataTable() As DataTable
        'return table that has total employee numbers for each shift of each location
        'need to add Formatting for the table
        Dim returnTable As New DataTable
        returnTable.Columns.Add("Job")
        returnTable.Columns.Add("Shift 1: 12 AM - 6 AM")
        returnTable.Columns.Add("Shift 2: 6 AM - 12 PM")
        returnTable.Columns.Add("Shift 3: 12 PM - 6 PM")
        returnTable.Columns.Add("Shift 4: 6 PM - 12 AM")
        Dim totalWorking As Integer
        For j = 0 To 5
            Dim newrow As DataRow = returnTable.NewRow
            If j = 0 Then
                newrow("Job") = "Housekeep"
            ElseIf j = 1 Then
                newrow("Job") = "Front Desk"
            ElseIf j = 2 Then
                newrow("Job") = "Life Guard"
            ElseIf j = 3 Then
                newrow("Job") = "Beach Attendant"
            ElseIf j = 4 Then
                newrow("Job") = "Spa"
            ElseIf j = 5 Then
                newrow("Job") = "Restaurant"
            End If

            For k = 0 To 3
                totalWorking = 0
                For i = 0 To myEmployeeList.Count - 1
                    totalWorking += myEmployeeAssignments(i, j, k).ToDouble
                Next
                If k = 0 Then
                    newrow("Shift 1: 12 AM - 6 AM") = totalWorking
                ElseIf k = 1 Then
                    newrow("Shift 2: 6 AM - 12 PM") = totalWorking
                ElseIf k = 2 Then
                    newrow("Shift 3: 12 PM - 6 PM") = totalWorking
                ElseIf k = 3 Then
                    newrow("Shift 4: 6 PM - 12 AM") = totalWorking
                End If

            Next
        Next
        Return returnTable
    End Function
End Class
